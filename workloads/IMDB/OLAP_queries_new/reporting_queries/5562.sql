SELECT AVG("movie_companies"."company_id") as agg_0 FROM "movie_companies" LEFT OUTER JOIN "company_name" ON "movie_companies"."company_id" = "company_name"."id" LEFT OUTER JOIN "title" ON "movie_companies"."movie_id" = "title"."id" LEFT OUTER JOIN "company_type" ON "movie_companies"."company_type_id" = "company_type"."id"  WHERE ("company_name"."country_code" != '%[sz]%' OR "company_name"."country_code" NOT LIKE '%[g%b]%') AND "movie_companies"."movie_id" <= 2107678 AND "movie_companies"."note" NOT LIKE '%(2008)%' AND "company_type"."id" BETWEEN 2 AND 3 AND "title"."id" IS NOT NULL;